{% extends "base.html" %}
{% block title %}{{ r.title }} ‚Äî CookNet AI{% endblock %}
{% block content %}

<div class="container">
  <div class="recipe-card">
    <img src="{{ r.photo_url or '/static/no-photo.jpg' }}" alt="{{ r.title }}">

    <h2>{{ r.title }}</h2>
    <p class="text-muted">
      üë§ –ê–≤—Ç–æ—Ä: <strong>@{{ r.username }}</strong>  
      <br>
      üïí {{ r.created_at[:10] }}
    </p>

    <p style="font-size: 18px; margin-top: 10px;">
      {{ r.ai_caption or r.description }}
    </p>

    <form method="post" action="/like/{{ r.id }}">
      <button class="like-btn" type="submit">‚ù§Ô∏è –õ–∞–π–∫ ({{ r.likes }})</button>
      <a href="/recipes" style="margin-left:10px;">‚Üê –ù–∞–∑–∞–¥ –∫ —Ä–µ—Ü–µ–ø—Ç–∞–º</a>
    </form>
  </div>

  <hr>

  <h3>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>

  {% if r.comments %}
    {% for c in r.comments %}
      <div class="recipe-card" style="padding:10px; background:#fff9f2;">
        <strong>@{{ c.username }}</strong>
        <p style="margin:5px 0;">{{ c.text }}</p>
        <small style="color:#999;">{{ c.created_at[:16].replace('T',' ') }}</small>
      </div>
    {% endfor %}
  {% else %}
    <p class="text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ üòå</p>
  {% endif %}

  <hr>

  <h4>‚úçÔ∏è –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h4>
  <form method="post" action="/comment/{{ r.id }}">
    <input type="text" name="username" placeholder="–í–∞—à –Ω–∏–∫" required
           style="width:100%;padding:8px;margin-bottom:8px;border-radius:6px;border:1px solid #ccc;">
    <textarea name="text" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." required
              style="width:100%;padding:8px;height:80px;margin-bottom:8px;border-radius:6px;border:1px solid #ccc;"></textarea>
    <label>–°–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 2+3? (–ø—Ä–æ–≤–µ—Ä–∫–∞)</label>
    <input type="text" name="captcha" required
           style="width:100px;padding:5px;margin:5px;border-radius:6px;border:1px solid #aaa;">
    <br>
    <button type="submit" class="like-btn">üí¨ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </form>
</div>

{% endblock %}
